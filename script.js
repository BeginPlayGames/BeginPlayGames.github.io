// Translations
const translations = {
    en: {
        heroTitle: "SILENT LIFE",
        heroSubtitle: "Survive the Occupation",
        buyText: "COMING SOON",
        aboutTitle: "ABOUT THE GAME",
        aboutText: "Silent Life is a hardcore survival simulation set in an occupied territory. No monsters, no radiation - just the harsh reality of living under occupation. Every decision matters. Every resource counts. Will you survive?",
        featuresTitle: "KEY FEATURES",
        feature1Title: "HARDCORE SURVIVAL",
        feature1Text: "Manage hunger, thirst, and health in a world where resources are scarce and danger lurks around every corner.",
        feature2Title: "STEALTH & TACTICS",
        feature2Text: "Avoid patrols, hide in shadows, and make strategic decisions to stay alive in occupied territory.",
        feature3Title: "RESOURCE MANAGEMENT",
        feature3Text: "Scavenge for supplies, craft tools, and make every item count in your struggle for survival.",
        feature4Title: "MORAL CHOICES",
        feature4Text: "Face difficult decisions that test your humanity. Will you help others or focus on your own survival?",
        feature5Title: "BASE BUILDING",
        feature5Text: "Fortify your shelter, set traps, and create a safe haven to rest and craft in safety.",
        feature6Title: "DYNAMIC WEATHER",
        feature6Text: "Survive through rain, snow, and fog. Weather affects visibility and survival stats.",
        galleryTitle: "SCREENSHOTS",
        mediaTitle: "VIDEOS",
        newsTitle: "LATEST NEWS",
        news1Date: "DEC 18, 2025",
        news1Title: "ALPHA TESTING BEGINS",
        news1Text: "The first wave of survivors has entered the zone. Reports are coming in.",
        news2Date: "DEC 10, 2025",
        news2Title: "NEW TOOLS REVEALED",
        news2Text: "Check out the new crafting system and survival tools added in the latest patch.",
        news3Date: "NOV 25, 2025",
        news3Title: "DEVELOPER DIARY #4",
        news3Text: "Behind the scenes look at the AI behavior and stealth mechanics.",
        newsReadMore: "READ MORE >",
        contactTitle: "CONTACT",
        contactYoutube: "YouTube:",
        contactEmail: "Email:",
        contactPatreon: "Patreon:",
        footerCopyright: "© 2024 SILENT LIFE. All rights reserved."
    },
    ru: {
        heroTitle: "SILENT LIFE",
        heroSubtitle: "Выживи в Оккупации",
        buyText: "СКОРО В ПРОДАЖЕ",
        aboutTitle: "ОБ ИГРЕ",
        aboutText: "Silent Life — это хардкорный симулятор выживания на оккупированной территории. Никаких монстров, никакой радиации — только суровая реальность жизни под оккупацией. Каждое решение имеет значение. Каждый ресурс на счету. Сможешь ли ты выжить?",
        featuresTitle: "КЛЮЧЕВЫЕ ОСОБЕННОСТИ",
        feature1Title: "ХАРДКОРНОЕ ВЫЖИВАНИЕ",
        feature1Text: "Управляй голодом, жаждой и здоровьем в мире, где ресурсы скудны, а опасность подстерегает за каждым углом.",
        feature2Title: "СКРЫТНОСТЬ И ТАКТИКА",
        feature2Text: "Избегай патрулей, прячься в тенях и принимай стратегические решения, чтобы остаться в живых на оккупированной территории.",
        feature3Title: "УПРАВЛЕНИЕ РЕСУРСАМИ",
        feature3Text: "Ищи припасы, создавай инструменты и цени каждый предмет в своей борьбе за выживание.",
        feature4Title: "МОРАЛЬНЫЙ ВЫБОР",
        feature4Text: "Столкнись с трудными решениями, которые проверят твою человечность. Поможешь другим или сосредоточишься на собственном выживании?",
        feature5Title: "СТРОИТЕЛЬСТВО БАЗЫ",
        feature5Text: "Укрепляй убежище, расставляй ловушки и создай безопасное место для отдыха и крафта.",
        feature6Title: "ДИНАМИЧЕСКАЯ ПОГОДА",
        feature6Text: "Выживай в дождь, снег и туман. Погода влияет на видимость и показатели выживания.",
        galleryTitle: "СКРИНШОТЫ",
        mediaTitle: "ВИДЕО",
        newsTitle: "НОВОСТИ",
        news1Date: "18 ДЕК 2025",
        news1Title: "СТАРТ АЛЬФА-ТЕСТА",
        news1Text: "Первая волна выживших вошла в зону. Отчеты поступают.",
        news2Date: "10 ДЕК 2025",
        news2Title: "НОВЫЕ ИНСТРУМЕНТЫ",
        news2Text: "Взгляните на новую систему крафта и инструменты выживания в последнем патче.",
        news3Date: "25 НОЯ 2025",
        news3Title: "ДНЕВНИК РАЗРАБОТКИ #4",
        news3Text: "За кулисами: поведение ИИ и механика скрытности.",
        newsReadMore: "ЧИТАТЬ ДАЛЕЕ >",
        contactTitle: "КОНТАКТЫ",
        contactYoutube: "YouTube:",
        contactEmail: "Email:",
        contactPatreon: "Patreon:",
        footerCopyright: "© 2024 SILENT LIFE. Все права защищены."
    },
    ua: {
        heroTitle: "SILENT LIFE",
        heroSubtitle: "Вижити в Окупації",
        buyText: "СКОРО У ПРОДАЖУ",
        aboutTitle: "ПРО ГРУ",
        aboutText: "Silent Life — це хардкорний симулятор виживання на окупованій території. Ніяких монстрів, ніякої радіації — лише сувора реальність життя під окупацією. Кожне рішення має значення. Кожен ресурс на рахунку. Чи зможеш ти вижити?",
        featuresTitle: "КЛЮЧОВІ ОСОБЛИВОСТІ",
        feature1Title: "ХАРДКОРНЕ ВИЖИВАННЯ",
        feature1Text: "Керуй голодом, спрагою та здоров'ям у світі, де ресурси обмежені, а небезпека чатує за кожним рогом.",
        feature2Title: "СКРИТНІСТЬ І ТАКТИКА",
        feature2Text: "Уникай патрулів, ховайся в тінях і приймай стратегічні рішення, щоб залишитися живим на окупованій території.",
        feature3Title: "УПРАВЛІННЯ РЕСУРСАМИ",
        feature3Text: "Шукай припаси, створюй інструменти та цінуй кожен предмет у своїй боротьбі за виживання.",
        feature4Title: "МОРАЛЬНИЙ ВИБІР",
        feature4Text: "Зіткнися зі складними рішеннями, які перевірять твою людяність. Допоможеш іншим чи зосередишся на власному виживанні?",
        galleryTitle: "СКРІНШОТИ",
        mediaTitle: "ВІДЕО",
        newsTitle: "НОВИНИ",
        contactTitle: "КОНТАКТИ",
        contactYoutube: "YouTube:",
        contactEmail: "Email:",
        contactPatreon: "Patreon:",
        footerCopyright: "© 2024 SILENT LIFE. Всі права захищені."
    }
};

// Set Language Function
function setLanguage(lang) {
    // Fallback if language not found
    if (!translations[lang]) {
        console.warn(`Language '${lang}' not found, defaulting to 'en'`);
        lang = 'en';
    }

    const t = translations[lang];

    // Helper to safely set text content
    const setText = (id, text) => {
        const el = document.getElementById(id);
        if (el) {
            el.textContent = text;
        }
    };

    // Update all text elements safely
    setText('hero-title', t.heroTitle);
    setText('hero-subtitle', t.heroSubtitle);
    setText('buy-text', t.buyText);
    setText('about-title', t.aboutTitle);
    setText('about-text', t.aboutText);
    setText('features-title', t.featuresTitle);
    setText('feature1-title', t.feature1Title);
    setText('feature1-text', t.feature1Text);
    setText('feature2-title', t.feature2Title);
    setText('feature2-text', t.feature2Text);
    setText('feature3-title', t.feature3Title);
    setText('feature3-text', t.feature3Text);
    setText('feature4-title', t.feature4Title);
    setText('feature4-text', t.feature4Text);
    setText('feature5-title', t.feature5Title);
    setText('feature5-text', t.feature5Text);
    setText('feature6-title', t.feature6Title);
    setText('feature6-text', t.feature6Text);
    setText('gallery-title', t.galleryTitle);
    setText('media-title', t.mediaTitle);
    setText('news-title', t.newsTitle);
    setText('news1-date', t.news1Date);
    setText('news1-title', t.news1Title);
    setText('news1-text', t.news1Text);
    setText('news2-date', t.news2Date);
    setText('news2-title', t.news2Title);
    setText('news2-text', t.news2Text);
    setText('news3-date', t.news3Date);
    setText('news3-title', t.news3Title);
    setText('news3-text', t.news3Text);
    // Update all readmore links
    document.querySelectorAll('.news-link').forEach(link => link.textContent = t.newsReadMore);

    setText('contact-title', t.contactTitle);
    setText('contact-youtube', t.contactYoutube);
    setText('contact-email', t.contactEmail);
    setText('contact-patreon', t.contactPatreon);
    setText('footer-copyright', t.footerCopyright);

    // Update active language button
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-lang') === lang) {
            btn.classList.add('active');
        }
    });

    // Save language preference
    try {
        localStorage.setItem('selectedLanguage', lang);
    } catch (e) {
        console.warn('Could not save language preference:', e);
    }
}

// Make setLanguage available globally
window.setLanguage = setLanguage;

// Modal Functions
function openModal(src) {
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImg');
    modalImg.src = src;
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

function closeModal() {
    const modal = document.getElementById('imageModal');
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
}

// Make modal functions available globally
window.openModal = openModal;
window.closeModal = closeModal;

// Auth Modal Functions
function openAuthModal() {
    const modal = document.getElementById('authModal');
    if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }
}

function closeAuthModal() {
    const modal = document.getElementById('authModal');
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
}

function switchAuthTab(tabName) {
    // Update tabs
    document.querySelectorAll('.auth-tab').forEach(tab => tab.classList.remove('active'));

    // Safety check for tab elements
    const selectedTab = document.getElementById(`tab-${tabName}`);
    if (selectedTab) selectedTab.classList.add('active');

    // Update forms
    document.querySelectorAll('.auth-form').forEach(form => form.classList.remove('active'));

    const selectedForm = document.getElementById(`${tabName}Form`);
    if (selectedForm) selectedForm.classList.add('active');
}

function handleLogin(e) {
    e.preventDefault();
    alert('ACCESS GRANTED. Welcome back, survivor.');
    closeAuthModal();
}

function handleSignup(e) {
    e.preventDefault();
    alert('REGISTRATION COMPLETE. Welcome to the resistance.');
    closeAuthModal();
}

// Make auth functions available globally
window.openAuthModal = openAuthModal;
window.closeAuthModal = closeAuthModal;
window.switchAuthTab = switchAuthTab;
window.handleLogin = handleLogin;
window.handleSignup = handleSignup;

// News Data Content
const newsData = {
    en: {
        news1: {
            date: "DEC 18, 2025",
            title: "ALPHA TESTING BEGINS",
            text: `<p>The long-awaited moment has arrived. The first wave of survivors has officially entered the Zone. We are seeing incredible engagement and are already gathering valuable feedback on the core mechanics.</p>
                   <p>Remember, this is an Alpha. Expect bugs, expect harsh conditions, and expect no mercy. Your reports are vital for the future of Silent Life.</p>
                   <p>Join our Discord to report issues and share your survival stories directly with the dev team.</p>`,
            image: "./Images/Screenshots/Screen1.jpg"
        },
        news2: {
            date: "DEC 10, 2025",
            title: "NEW TOOLS REVEALED",
            text: `<p>Survival isn't just about hiding; it's about adapting. In the latest patch, we introduced a suite of new improvised tools.</p>
                   <p>From the makeshift lockpick to the reinforced crowbar, these tools allow you to access previously unreachable areas of the map. But be warned: using them creates noise, and noise attracts unwanted attention.</p>
                   <p>Check the crafting menu for new recipes!</p>`,
            image: "./Images/Screenshots/Screen2.jpg"
        },
        news3: {
            date: "NOV 25, 2025",
            title: "DEVELOPER DIARY #4",
            text: `<p>In this diary, we dive deep into the AI behavior improvements. The occupation forces are no longer just patrolling on fixed paths.</p>
                   <p>They now react to sound, light, and visual disturbances. If they find an open door that should be closed, they will investigate. If they hear a twig snap, they will flank you.</p>
                   <p>Stealth is now more challenging—and more rewarding—than ever.</p>`,
            image: "./Images/Screenshots/Screen3.jpg"
        }
    },
    ru: {
        news1: {
            date: "18 ДЕК 2025",
            title: "СТАРТ АЛЬФА-ТЕСТА",
            text: `<p>Долгожданный момент настал. Первая волна выживших официально вошла в Зону. Мы видим невероятную активность и уже собираем ценные отзывы об основных механиках.</p>
                   <p>Помните, это Альфа. Ожидайте баги, ожидайте суровые условия и не ждите пощады. Ваши отчеты жизненно важны для будущего Silent Life.</p>
                   <p>Присоединяйтесь к нашему Discord, чтобы сообщать об ошибках и делиться своими историями выживания напрямую с разработчиками.</p>`,
            image: "./Images/Screenshots/Screen1.jpg"
        },
        news2: {
            date: "10 ДЕК 2025",
            title: "НОВЫЕ ИНСТРУМЕНТЫ",
            text: `<p>Выживание — это не просто прятки, это адаптация. В последнем патче мы представили набор новых самодельных инструментов.</p>
                   <p>От самодельной отмычки до усиленного лома — эти инструменты позволят вам попасть в ранее недоступные участки карты. Но будьте осторожны: их использование создает шум, а шум привлекает нежелательное внимание.</p>
                   <p>Проверьте меню крафта на наличие новых рецептов!</p>`,
            image: "./Images/Screenshots/Screen2.jpg"
        },
        news3: {
            date: "25 НОЯ 2025",
            title: "ДНЕВНИК РАЗРАБОТКИ #4",
            text: `<p>В этом дневнике мы углубимся в улучшения поведения ИИ. Оккупационные силы больше не просто патрулируют по заданным маршрутам.</p>
                   <p>Теперь они реагируют на звук, свет и визуальные нарушения. Если они найдут открытую дверь, которая должна быть закрыта, они пойдут проверять. Если услышат хруст ветки — попытаются обойти вас с фланга.</p>
                   <p>Скрытность теперь сложнее — и интереснее — чем когда-либо.</p>`,
            image: "./Images/Screenshots/Screen3.jpg"
        }
    },
    ua: {
        news1: {
            date: "18 ГРУ 2025",
            title: "СТАРТ АЛЬФА-ТЕСТУ",
            text: `<p>Довгоочікуваний момент настав. Перша хвиля тих, хто вижив, офіційно увійшла в Зону. Ми бачимо неймовірну активність і вже збираємо цінні відгуки про основні механіки.</p>
                   <p>Пам'ятайте, це Альфа. Очікуйте баги, очікуйте сурові умови і не чекайте пощади. Ваші звіти життєво важливі для майбутнього Silent Life.</p>
                   <p>Приєднуйтесь до нашого Discord, щоб повідомляти про помилки та ділитися своїми історіями виживання безпосередньо з розробниками.</p>`,
            image: "./Images/Screenshots/Screen1.jpg"
        },
        news2: {
            date: "10 ГРУ 2025",
            title: "НОВІ ІНСТРУМЕНТЫ",
            text: `<p>Виживання — це не просто хованки, це адаптація. В останньому патчі ми представили набір нових саморобних інструментів.</p>
                   <p>Від саморобної відмички до посиленого лома — ці інструменти дозволять вам потрапити в раніше недоступні ділянки карти. Але будьте обережні: їх використання створює шум, а шум привертає небажану увагу.</p>
                   <p>Перевірте меню крафту на наявність нових рецептів!</p>`,
            image: "./Images/Screenshots/Screen2.jpg"
        },
        news3: {
            date: "25 ЛИС 2025",
            title: "ЩОДЕННИК РОЗРОБКИ #4",
            text: `<p>У цьому щоденнику ми заглибимося в покращення поведінки ШІ. Окупаційні сили більше не просто патрулюють по заданих маршрутах.</p>
                   <p>Тепер вони реагують на звук, світло і візуальні порушення. Якщо вони знайдуть відкриті двері, які повинні бути закриті, вони підуть перевіряти. Якщо почують хрускіт гілки — спробують обійти вас з флангу.</p>
                   <p>Скритність тепер складніша — і цікавіша — ніж будь-коли.</p>`,
            image: "./Images/Screenshots/Screen3.jpg"
        }
    }
};

// News Modal Functions
function openNewsModal(newsId) {
    const modal = document.getElementById('newsModal');

    // Get current language from localStorage or default to english
    const currentLang = localStorage.getItem('selectedLanguage') || 'en';

    // Fallback to english content if specific language is missing, or safety check
    const langData = newsData[currentLang] || newsData['en'];
    const content = langData[newsId];

    if (content) {
        document.getElementById('modal-news-date').textContent = content.date;
        document.getElementById('modal-news-title').textContent = content.title;
        document.getElementById('modal-news-image').src = content.image;
        document.getElementById('modal-news-body').innerHTML = content.text;

        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
    } else {
        console.error('News content not found for ID:', newsId);
    }
}

function closeNewsModal() {
    const modal = document.getElementById('newsModal');
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
}

// Make globally available
window.openNewsModal = openNewsModal;
window.closeNewsModal = closeNewsModal;

// Close modal on outside click (reusing existing listener logic if possible, or adding new)
window.addEventListener('click', (e) => {
    const authModal = document.getElementById('authModal');
    const newsModal = document.getElementById('newsModal');

    if (e.target === authModal) {
        closeAuthModal();
    }
    if (e.target === newsModal) {
        closeNewsModal();
    }
});

// Close modal on Escape key (Enhanced existing listener)
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeModal(); // Existing image modal
        closeAuthModal(); // Auth modal
        closeNewsModal(); // News modal
    }
});

// Parallax Effect
let ticking = false;
window.addEventListener('scroll', () => {
    if (!ticking) {
        window.requestAnimationFrame(() => {
            const scrolled = window.pageYOffset;
            const hero = document.getElementById('hero');
            if (hero) {
                hero.style.backgroundPositionY = scrolled * 0.5 + 'px';
            }
            ticking = false;
        });
        ticking = true;
    }
});

// Intersection Observer for Animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -100px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
        }
    });
}, observerOptions);

// Observe elements for animation
document.addEventListener('DOMContentLoaded', () => {
    // Load saved language or default to English
    const savedLang = localStorage.getItem('selectedLanguage') || 'en';
    setLanguage(savedLang);

    // Setup language button click handlers
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.preventDefault();
            const lang = btn.getAttribute('data-lang');
            setLanguage(lang);
        });
    });

    // Animate feature cards
    const featureCards = document.querySelectorAll('.feature-card');
    featureCards.forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(card);
    });

    // Animate gallery items
    const galleryItems = document.querySelectorAll('.gallery-item');
    galleryItems.forEach((item, index) => {
        item.style.opacity = '0';
        item.style.transform = 'translateY(30px)';
        item.style.transition = `opacity 0.6s ease ${index * 0.1}s, transform 0.6s ease ${index * 0.1}s`;
        observer.observe(item);
    });
});

// Smooth scroll for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// Add loading animation
window.addEventListener('load', () => {
    document.body.style.opacity = '0';
    setTimeout(() => {
        document.body.style.transition = 'opacity 0.5s ease';
        document.body.style.opacity = '1';
    }, 100);
});

console.log('SILENT LIFE - Survive the Occupation');